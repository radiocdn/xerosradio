const API_URL="https://xr-api.faststreamdiensten.nl/api/xerosradio/vote/uitslag.php",FALLBACK_IMAGE="https://res.cloudinary.com/xerosradio/image/upload/f_webp,q_auto/XerosRadio_Logo";let allSongs=[];async function fetchTopSongs(){try{const a=await fetch(API_URL);if(!a.ok)throw new Error("API geeft geen geldig antwoord.");let b=await a.json();b.sort((c,a)=>a.votes-c.votes),allSongs=b.map((a,b)=>({...a,realRank:b+1})),filterSongs()}catch(a){document.getElementById("song-list").innerHTML=`
      <div class="col mx-auto">
        <div class="alert alert-danger text-center mx-auto" style="width: fit-content;">‚ùå Kan de lijst niet laden. Probeer het later opnieuw.</div>
      </div>`}}function filterSongs(){const a=document.getElementById("searchInput").value.toLowerCase(),c=document.getElementById("sortSelect").value;let d=allSongs.filter(b=>b.title.toLowerCase().includes(a)||b.artist.toLowerCase().includes(a));d.sort((d,a)=>"asc"===c?d.votes-a.votes:a.votes-d.votes),renderSongs(d)}function renderSongs(a){const b=document.getElementById("song-list");return b.querySelectorAll(".loading").forEach(a=>a.remove()),b.innerHTML="",0===a.length?void(b.innerHTML=`
      <div class="col mx-auto">
        <div class="alert alert-warning text-center mx-auto" style="width: fit-content;">‚ö†Ô∏è Geen resultaten gevonden.</div>
      </div>`):void a.forEach((a,c)=>{const d=`
      <div class="col">
        <div class="song-card card h-100" tabindex="0" aria-label="#${a.realRank} - ${a.title} door ${a.artist}, ${a.votes} stemmen" style="animation-delay: ${100*c+"ms"};">
          <img src="${a.cover_url||FALLBACK_IMAGE}" alt="Cover van ${a.title}" class="song-cover" onerror="this.src='${FALLBACK_IMAGE}'" />
          <div class="card-body">
            <h5 class="card-title">#${a.realRank} - ${a.title}</h5>
            <p class="card-text">üé§ ${a.artist}</p>
          </div>
          <div class="card-footer">
            <span class="votes">${a.votes} stemmen</span>
          </div>
        </div>
      </div>`;b.insertAdjacentHTML("beforeend",d)})}fetchTopSongs();