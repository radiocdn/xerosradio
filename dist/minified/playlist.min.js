document.addEventListener("DOMContentLoaded",()=>{function b(a,b="",c=""){const d=document.createElement(a);return b&&(d.className=b),c&&(d.textContent=c),d}function c(a){if(!a)return"";if(/^\d{2}:\d{2}$/.test(a))return a;const b=new Date(a);return isNaN(b)?a:b.toLocaleString("nl-NL",{hour:"2-digit",minute:"2-digit"})}function d(a){const d=a.artist||"Onbekend",e=a.title||"Onbekend nummer",f=c(a.played_at),g=a.cover_art200x200&&a.cover_art200x200.startsWith("http")?a.cover_art200x200:l,h=b("div","playlist-item"),i=b("img","song-cover-playlist lozad");i.alt=`${d} - ${e}`,i.setAttribute("decoding","async"),i.draggable=!1,i.dataset.src=g,i.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",i.onerror=()=>{i.src=l,i.removeAttribute("data-src"),i.classList.remove("lozad")};const j=b("div","details"),k=b("h2","",d),m=b("p","",e);if(a.dj&&""!==a.dj.trim()){const c=b("p","dj-name");if(c.textContent=`Gedraaid door ${a.dj}`,a.dj_cover&&a.dj_cover.startsWith("http")){const d=b("img","dj-cover lozad");d.alt=a.dj,d.setAttribute("decoding","async"),d.draggable=!1,d.dataset.src=a.dj_cover,d.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",d.onerror=()=>{d.style.display="none",d.removeAttribute("data-src"),d.classList.remove("lozad")},c.appendChild(d)}j.appendChild(c)}const n=b("p","",f);j.append(k,m,n);const o=b("div","spotify-youtube-container"),p=encodeURIComponent(`${d} - ${e}`),q=[{href:`https://open.spotify.com/search/${p}`,icon:"fab fa-spotify spotify-icon",label:"Zoek op Spotify"},{href:`https://www.youtube.com/results?search_query=${p}`,icon:"fab fa-youtube youtube-icon",label:"Zoek op YouTube"},{href:`https://soundcloud.com/search?q=${p}`,icon:"fab fa-soundcloud soundcloud-icon",label:"Zoek op SoundCloud"}];return q.forEach(({href:c,icon:d,label:e})=>{const f=b("a");f.href=c,f.target="_blank",f.rel="noopener",f.setAttribute("aria-label",e),f.innerHTML=`<i class="${d}"></i>`,o.appendChild(f)}),h.append(i,j,o),h}async function e(a,b={},c=2,d=500){for(let e=0;e<=c;e++)try{const c=await fetch(a,b);if(!c.ok)throw new Error("Kan de afspeellijst niet laden.");return await c.json()}catch(a){if(e===c)throw a;await new Promise(a=>setTimeout(a,d))}}function f(){j.innerHTML=`
            <div class="col mx-auto">
                <div class="alert alert-info text-center mx-auto" style="width: fit-content; display: flex; align-items: center; gap: 10px;">
                    <svg width="24" height="24" viewBox="0 0 50 50" aria-hidden="true" focusable="false" style="vertical-align:middle">
                        <circle cx="25" cy="25" r="20" fill="none" stroke="#8008f0ff" stroke-width="5" stroke-linecap="round" stroke-dasharray="31.415, 31.415" transform="rotate(72.3242 25 25)">
                            <animateTransform attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="1s" repeatCount="indefinite"/>
                        </circle>
                    </svg>
                    Laden van de Playlist...
                </div>
            </div>
        `}function g(){j.innerHTML=`
            <div class="col mx-auto">
                <div class="alert alert-info text-center mx-auto" style="width: fit-content;">ℹ️ Helaas, er zijn geen nummers gevonden.</div>
            </div>
        `}function h(a){j.innerHTML=`
            <div class="col mx-auto">
                <div class="alert alert-danger text-center mx-auto" style="width: fit-content;">❌ Fout bij het laden van de afspeellijst, probeer het later opnieuw.</div>
            </div>
        `}async function i(){f();try{const a=await e(k);if(j.innerHTML="",!Array.isArray(a)||0===a.length)return void g();const b=document.createDocumentFragment();if(a.forEach(a=>b.appendChild(d(a))),j.appendChild(b),n)n.observe();else{const a=j.querySelectorAll("img[data-src]");a.forEach(a=>{a.src=a.dataset.src||a.src,a.removeAttribute("data-src")})}}catch(a){h(a.message),console.error(a)}}const j=document.getElementById("playlist-container"),k="https://xr-api-prd.faststreamdiensten.nl/playlist",l="https://res.cloudinary.com/xerosradio/image/upload/f_webp,q_auto,w_200,h_200/v1/Assets/website/default_cover_art_ie9hax";let m=null,n=null;window.lozad?n=lozad(".lozad",{rootMargin:"10px 0px",threshold:.1,loaded:function(a){a.classList.add("lozad-loaded")}}):console.warn("lozad not found - images will not be lazy-loaded"),function a(){let c=document.getElementById("playlist-refresh-btn");c||(c=b("button","xerosradiobutton"),c.id="playlist-refresh-btn",c.type="button",c.innerHTML="<i class=\"fa fa-rotate-right\" aria-hidden=\"true\"></i> Vernieuwen",c.title="Vernieuw de afspeellijst",c.style.margin="10px 0 10px 8px",c.onclick=async()=>{c.disabled=!0,f();try{await i()}finally{c.disabled=!1}},j.parentNode.insertBefore(c,j))}(),i().then(function a(){m&&clearInterval(m),m=setInterval(async()=>{const a=document.getElementById("playlist-refresh-btn");if(!a.disabled){a.disabled=!0;try{await i()}finally{a.disabled=!1}}},60000)})});